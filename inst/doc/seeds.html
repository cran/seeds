<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Seeds: Calculating the hidden inputs in a system</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Seeds: Calculating the hidden inputs in a system</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The algorithms contained in the <em>seeds</em> package are implementation of the dynamic elastic net approach. There are two algorithms implemented that aim to calculate missing interactions between states of an ode in order to explain and minimize a systematic error within the model-equation. The hidden inputs should be an hint as to which states are missing interactions.</p>
<p>Both algorithm makes heavy use of the deSolve package. The use of Rtools is recommended to significantly shorten the computing time of the algorithm. It is not possible to use the BDEN algorithm without Rtools.</p>
<div id="the-den-dynamic-elastic-net-algorithm" class="section level2">
<h2>The DEN (dynamic elastic net) Algorithm</h2>
<p>The first Algorithm is a greedy method for generating a sparse solution for the hidden inputs. The algorithm is based on Pontryaginâ€™s Maximum Principle and implements an iterative gradient descent method which aims at minimizing the Hamilton function of the system.</p>
<p>Rtools is suggested, because of the immense computational cost of the step size estimation of the gradient step.</p>
</div>
<div id="the-odemodel-class" class="section level2">
<h2>The odeModel Class</h2>
<p>The class aims to be used to describe the experiment you want to analyze. It has the following slots:</p>
<ul>
<li><strong>func</strong>: A function containing the ode-equations of the model. For syntax look at the given examples of the deSolve package.</li>
<li><strong>times</strong>: time steps at which the model should be evaluated</li>
<li><strong>parms</strong>: the parameters of the model</li>
<li><strong>input</strong>: matrix containing the inputs with the time points</li>
<li><strong>measFunc</strong>: function that converts the output of the ode solution</li>
<li><strong>y</strong>: initial (state) values of the ODE system, has to be a vector</li>
<li><strong>meas</strong>: matrix with the (experimental) measurements of the system</li>
<li><strong>sd</strong>: optional standard deviations of the measurements, is used by the algorithms as weights in the cost function</li>
<li><strong>custom</strong>: customized link function (is internally used)</li>
<li><strong>nnStates</strong>: bit vector that indicates if states should be observed by the root function</li>
<li><strong>nnTollerance</strong>: tolerance at which a function is seen as zero (optional)</li>
<li><strong>resetValue</strong>: value a state should be set to by an event (optional)</li>
</ul>
<p>The class also provides methods to simply evaluate and display the nominal solution of an created odeModel object with the <em>nominalSol</em> and <em>plot()</em> function.</p>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<p>The following example uses the UVB protein g model and some simulated measurement data. An synthetic error has been added to the states <span class="math inline">\(x_3\)</span> and <span class="math inline">\(x_{11}\)</span>.</p>
<p>The states of the model have to be written with the letter <span class="math inline">\(x\)</span> following by a number representing the state. If an input is needed for the model the input takes the letter <span class="math inline">\(u\)</span>. This restrictions are made to ensure that the automatic differentiation will work as intended.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(seeds)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># usb network example</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>uvbParameter =<span class="st"> </span><span class="kw">c</span>(  <span class="dt">ks1=</span><span class="fl">0.23</span>,</span>
<span id="cb1-5"><a href="#cb1-5"></a>                 <span class="dt">ks2=</span><span class="fl">4.0526</span>,</span>
<span id="cb1-6"><a href="#cb1-6"></a>                 <span class="dt">kdr1=</span><span class="fl">0.1</span>,</span>
<span id="cb1-7"><a href="#cb1-7"></a>                 <span class="dt">kdr2=</span><span class="fl">0.2118</span>,</span>
<span id="cb1-8"><a href="#cb1-8"></a>                 <span class="dt">k1=</span><span class="fl">0.0043</span>,</span>
<span id="cb1-9"><a href="#cb1-9"></a>                 <span class="dt">k2=</span><span class="fl">161.62</span>,</span>
<span id="cb1-10"><a href="#cb1-10"></a>                 <span class="dt">ka1=</span><span class="fl">0.0372</span>,</span>
<span id="cb1-11"><a href="#cb1-11"></a>                 <span class="dt">ka2=</span><span class="fl">0.0611</span>,</span>
<span id="cb1-12"><a href="#cb1-12"></a>                 <span class="dt">ka3=</span><span class="fl">4.7207</span>,</span>
<span id="cb1-13"><a href="#cb1-13"></a>                 <span class="dt">kd1=</span><span class="fl">94.3524</span>,</span>
<span id="cb1-14"><a href="#cb1-14"></a>                 <span class="dt">kd2=</span><span class="fl">50.6973</span>,</span>
<span id="cb1-15"><a href="#cb1-15"></a>                 <span class="dt">kd3=</span><span class="fl">0.5508</span>,</span>
<span id="cb1-16"><a href="#cb1-16"></a>                 <span class="dt">ks3=</span><span class="fl">0.4397</span>,</span>
<span id="cb1-17"><a href="#cb1-17"></a>                 <span class="dt">kdr3=</span><span class="fl">1.246</span>,</span>
<span id="cb1-18"><a href="#cb1-18"></a>                 <span class="dt">uv=</span><span class="dv">1</span>,</span>
<span id="cb1-19"><a href="#cb1-19"></a>                 <span class="dt">ka4=</span><span class="fl">10.1285</span>,</span>
<span id="cb1-20"><a href="#cb1-20"></a>                 <span class="dt">kd4=</span><span class="fl">1.1999</span>,</span>
<span id="cb1-21"><a href="#cb1-21"></a>                 <span class="dt">n1=</span><span class="dv">3</span>,</span>
<span id="cb1-22"><a href="#cb1-22"></a>                 <span class="dt">n2=</span><span class="dv">2</span>,</span>
<span id="cb1-23"><a href="#cb1-23"></a>                 <span class="dt">n3=</span><span class="fl">3.5</span>,</span>
<span id="cb1-24"><a href="#cb1-24"></a>                 <span class="dt">kdr3a=</span><span class="fl">0.9735</span>,</span>
<span id="cb1-25"><a href="#cb1-25"></a>                 <span class="dt">kdr3b=</span><span class="fl">0.406</span>,</span>
<span id="cb1-26"><a href="#cb1-26"></a>                 <span class="dt">ksr=</span><span class="fl">0.7537</span>,</span>
<span id="cb1-27"><a href="#cb1-27"></a>                 <span class="dt">fhy3_s=</span><span class="dv">5</span>)</span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="co"># initial state</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>x0 =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">4.2</span>,<span class="fl">0.25</span>,<span class="dv">20</span>,<span class="dv">0</span>)</span>
<span id="cb1-30"><a href="#cb1-30"></a></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="co"># model ode</span></span>
<span id="cb1-32"><a href="#cb1-32"></a>uvbModel &lt;-<span class="st"> </span><span class="cf">function</span>(t,x,parameters) {</span>
<span id="cb1-33"><a href="#cb1-33"></a>  <span class="kw">with</span> (<span class="kw">as.list</span>(parameters),{</span>
<span id="cb1-34"><a href="#cb1-34"></a></span>
<span id="cb1-35"><a href="#cb1-35"></a>  dx1 =<span class="st"> </span>((<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>((ka1 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(x[<span class="dv">4</span>]<span class="op">^</span><span class="dv">2</span>)) <span class="op">-</span><span class="st"> </span>(kd1 <span class="op">*</span><span class="st"> </span>x[<span class="dv">5</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="st">            </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>((ka2 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>]) <span class="op">-</span><span class="st"> </span>(kd2 <span class="op">*</span><span class="st"> </span>x[<span class="dv">3</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="st">            </span>((ks1 <span class="op">*</span>((<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(uv <span class="op">*</span><span class="st"> </span>n3 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">11</span>] <span class="op">+</span><span class="st"> </span>fhy3_s))))  <span class="op">-</span><span class="st"> </span></span>
<span id="cb1-38"><a href="#cb1-38"></a><span class="st">            </span>(kdr1 <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(n1 <span class="op">*</span><span class="st"> </span>uv)) <span class="op">*</span><span class="st"> </span>x[<span class="dv">1</span>])))</span>
<span id="cb1-39"><a href="#cb1-39"></a>  dx2 =<span class="st"> </span>((<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>((ka2<span class="op">*</span>(x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>]) <span class="op">-</span><span class="st"> </span>(kd2 <span class="op">*</span><span class="st"> </span>x[<span class="dv">3</span>])) <span class="op">+</span></span>
<span id="cb1-40"><a href="#cb1-40"></a><span class="st">            </span>(<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>((ka4 <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x[<span class="dv">12</span>]) <span class="op">-</span><span class="st"> </span>(kd4 <span class="op">*</span><span class="st"> </span>x[<span class="dv">13</span>])))</span>
<span id="cb1-41"><a href="#cb1-41"></a>  dx3 =<span class="st"> </span>(((ka2 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>]) <span class="op">-</span><span class="st"> </span>(kd2<span class="op">*</span><span class="st">  </span>x[<span class="dv">3</span>]))) </span>
<span id="cb1-42"><a href="#cb1-42"></a>  dx4 =<span class="st"> </span>((<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(k1<span class="op">*</span>(x[<span class="dv">4</span>]<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span>(<span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(k2 <span class="op">*</span><span class="st"> </span>x[<span class="dv">6</span>]) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-43"><a href="#cb1-43"></a><span class="st">           </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>((ka1 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="st"> </span>(x[<span class="dv">4</span>]<span class="op">^</span><span class="dv">2</span>)) <span class="op">-</span><span class="st"> </span>(kd1 <span class="op">*</span><span class="st"> </span>x[<span class="dv">5</span>])) <span class="op">+</span></span>
<span id="cb1-44"><a href="#cb1-44"></a><span class="st">           </span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="st"> </span>(ka3 <span class="op">*</span><span class="st"> </span>x[<span class="dv">4</span>] <span class="op">*</span>x[<span class="dv">7</span>]))</span>
<span id="cb1-45"><a href="#cb1-45"></a>  dx5 =<span class="st">  </span>(((ka1 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(x[<span class="dv">4</span>]<span class="op">^</span><span class="dv">2</span>)) <span class="op">-</span>(kd1 <span class="op">*</span><span class="st"> </span>x[<span class="dv">5</span>])))</span>
<span id="cb1-46"><a href="#cb1-46"></a>  dx6 =<span class="st"> </span>((<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(k2 <span class="op">*</span><span class="st"> </span>x[<span class="dv">6</span>]) <span class="op">+</span><span class="st">  </span>(k1 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">4</span>]<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span>(kd3 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">8</span>]<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb1-47"><a href="#cb1-47"></a>  dx7 =<span class="st"> </span>((<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(ka3 <span class="op">*</span><span class="st"> </span>x[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>x[<span class="dv">7</span>]) <span class="op">+</span><span class="st"> </span>((ks2 <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(uv <span class="op">*</span><span class="st"> </span>x[<span class="dv">5</span>]))) <span class="op">-</span><span class="st"> </span></span>
<span id="cb1-48"><a href="#cb1-48"></a><span class="st">              </span>(kdr2 <span class="op">*</span><span class="st"> </span>x[<span class="dv">7</span>])) <span class="op">+</span><span class="st"> </span>(<span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(kd3 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">8</span>]<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb1-49"><a href="#cb1-49"></a>  dx8 =<span class="st"> </span>((<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(kd3 <span class="op">*</span><span class="st"> </span>x[<span class="dv">8</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(ka3 <span class="op">*</span><span class="st"> </span>x[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>x[<span class="dv">7</span>])) </span>
<span id="cb1-50"><a href="#cb1-50"></a>  dx9  =<span class="st"> </span><span class="dv">0</span> </span>
<span id="cb1-51"><a href="#cb1-51"></a>  dx10 =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb1-52"><a href="#cb1-52"></a>  dx11 =<span class="st">  </span>(((ks3 <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(n2 <span class="op">*</span><span class="st"> </span>uv))) <span class="op">-</span>(kdr3 <span class="op">*</span><span class="st"> </span>(((x[<span class="dv">3</span>] <span class="op">/</span><span class="st"> </span>(kdr3a <span class="op">+</span><span class="st"> </span>x[<span class="dv">3</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-53"><a href="#cb1-53"></a><span class="st">            </span>(x[<span class="dv">13</span>] <span class="op">/</span><span class="st"> </span>(kdr3b <span class="op">+</span><span class="st"> </span>x[<span class="dv">13</span>]))) <span class="op">-</span>(x[<span class="dv">5</span>] <span class="op">/</span><span class="st"> </span>(ksr <span class="op">+</span><span class="st"> </span>x[<span class="dv">5</span>]))) <span class="op">*</span><span class="st">  </span>x[<span class="dv">11</span>])))</span>
<span id="cb1-54"><a href="#cb1-54"></a>  dx12 =<span class="st"> </span>((<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(ka4 <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x[<span class="dv">12</span>]) <span class="op">+</span><span class="st"> </span>(kd4 <span class="op">*</span><span class="st"> </span>x[<span class="dv">13</span>]))</span>
<span id="cb1-55"><a href="#cb1-55"></a>  dx13 =((ka4 <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x[<span class="dv">12</span>]) <span class="op">-</span><span class="st"> </span>(kd4 <span class="op">*</span><span class="st"> </span>x[<span class="dv">13</span>]))</span>
<span id="cb1-56"><a href="#cb1-56"></a>  </span>
<span id="cb1-57"><a href="#cb1-57"></a>  <span class="kw">list</span>(<span class="kw">c</span>(dx1,dx2,dx3,dx4,dx5,dx6,dx7,dx8,dx9,dx10,dx11,dx12,dx13))</span>
<span id="cb1-58"><a href="#cb1-58"></a>  })</span>
<span id="cb1-59"><a href="#cb1-59"></a>}</span>
<span id="cb1-60"><a href="#cb1-60"></a></span>
<span id="cb1-61"><a href="#cb1-61"></a><span class="co"># measurement function</span></span>
<span id="cb1-62"><a href="#cb1-62"></a>uvbMeasure &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb1-63"><a href="#cb1-63"></a>  </span>
<span id="cb1-64"><a href="#cb1-64"></a>  y1 =<span class="st"> </span><span class="dv">2</span><span class="op">*</span>x[,<span class="dv">5</span>] <span class="op">+</span><span class="st"> </span>x[,<span class="dv">4</span>] <span class="op">+</span><span class="st"> </span>x[,<span class="dv">8</span>]</span>
<span id="cb1-65"><a href="#cb1-65"></a>  y2 =<span class="st"> </span><span class="dv">2</span><span class="op">*</span>x[,<span class="dv">5</span>] <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="st"> </span>x[,<span class="dv">3</span>] <span class="op">+</span><span class="st"> </span>x[,<span class="dv">1</span>]</span>
<span id="cb1-66"><a href="#cb1-66"></a>  y3 =<span class="st"> </span>x[,<span class="dv">6</span>]</span>
<span id="cb1-67"><a href="#cb1-67"></a>  y4 =<span class="st"> </span>x[,<span class="dv">11</span>]</span>
<span id="cb1-68"><a href="#cb1-68"></a>  y5 =<span class="st"> </span>x[,<span class="dv">4</span>]</span>
<span id="cb1-69"><a href="#cb1-69"></a>  </span>
<span id="cb1-70"><a href="#cb1-70"></a>  <span class="kw">return</span>(<span class="kw">cbind</span>(y1,y2,y3,y4,y5))</span>
<span id="cb1-71"><a href="#cb1-71"></a>}</span>
<span id="cb1-72"><a href="#cb1-72"></a></span>
<span id="cb1-73"><a href="#cb1-73"></a><span class="co"># measurement data</span></span>
<span id="cb1-74"><a href="#cb1-74"></a>y &lt;-<span class="st"> </span>uvbData[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]</span>
<span id="cb1-75"><a href="#cb1-75"></a><span class="co"># timesteps</span></span>
<span id="cb1-76"><a href="#cb1-76"></a>t &lt;-<span class="st"> </span>uvbData<span class="op">$</span>t</span>
<span id="cb1-77"><a href="#cb1-77"></a><span class="co"># standard deviation of the measurements</span></span>
<span id="cb1-78"><a href="#cb1-78"></a>sd &lt;-<span class="st"> </span>uvbData[,<span class="dv">7</span><span class="op">:</span><span class="dv">11</span>]</span>
<span id="cb1-79"><a href="#cb1-79"></a>  </span>
<span id="cb1-80"><a href="#cb1-80"></a>uvbModel &lt;-<span class="st"> </span><span class="kw">odeModel</span>(<span class="dt">func =</span> uvbModel, <span class="dt">parms =</span> uvbParameter, <span class="dt">times =</span> t,</span>
<span id="cb1-81"><a href="#cb1-81"></a>           <span class="dt">measFunc =</span> uvbMeasure, <span class="dt">y =</span> x0, <span class="dt">meas =</span> y, <span class="dt">sd =</span> sd)</span>
<span id="cb1-82"><a href="#cb1-82"></a></span>
<span id="cb1-83"><a href="#cb1-83"></a>  </span>
<span id="cb1-84"><a href="#cb1-84"></a>res &lt;-<span class="st"> </span><span class="kw">DEN</span>(<span class="dt">odeModel =</span> uvbModel, <span class="dt">alphaStep =</span> <span class="dv">500</span>, <span class="dt">alpha2 =</span> <span class="fl">0.0001</span>, <span class="dt">epsilon =</span> <span class="fl">0.2</span>, <span class="dt">plotEstimates =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>The results are returned as list of resultsSeeds objects, which store the estimated states, measurements and the hidden inputs of a model. A standard plot function is given to display the results. Functions for annotating the plots are also included in the package. The use of the BDEN algorithm displays not only the calculated states and inputs, but also confidence intervals for the corresponding states of the system.</p>
<div id="plotting" class="section level3">
<h3>Plotting</h3>
<p>The standard plot gives you three figures:</p>
<ol style="list-style-type: decimal">
<li>The estimated states (blue without hidden inputs, red with hidden inputs)</li>
<li>The estimated hidden inputs</li>
<li>The estimated measurements. (blue without hidden inputs, red with hidden inputs)</li>
</ol>
<p>All calculated values can be output by methods of the class odeModel, or extracted directly by the corresponding slots. The structure and methods of the class can be found in the corresponding documentation.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># plot the solution of the second iteration</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">plot</span>(res[[<span class="dv">2</span>]])</span></code></pre></div>
<p>The plotting function will give you three plots.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Estimated States for the model</p>
</div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Estimated hidden inputs</p>
</div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Measurements resulting from the estimated hidden inputs</p>
</div>
<hr />
</div>
</div>
</div>
<div id="bayesian-dynamic-elastic-net" class="section level1">
<h1>Bayesian Dynamic Elastic Net</h1>
<p>Full Bayesian algorithm to detect hidden inputs in ODE based models.The algorithm is an extension of the Dynamic Elastic Net algorithm (Engelhardt et al.Â 2016) inspired by the Elastic-Net Regression.</p>
<p>Ordinary differential equations (ODEs) are a popular approach to quantitatively model molecular networks based on biological knowledge. However, such knowledge is typically restricted. Wrongly modeled biological mechanisms as well as relevant external influence factors that are not included into the model likely manifest in major discrepancies between model predictions and experimental data. Finding the exact reasons for such observed discrepancies can be quite challenging in practice. In order to address this issue we suggest a Bayesian approach to estimate hidden influences in ODE based models. The method can distinguish between exogenous and endogenous hidden influences. Thus, we can detect wrongly specified as well as missed molecular interactions in the model.</p>
<p>The BDEN as a new and fully probabilistic approach, supports the modeler in an algorithmic manner to identify possible sources of errors in ODE based models on the basis of experimental data. THE BDEN does not require pre-specified hyper-parameters.</p>
<p>BDEN thus provides a systematic Bayesian computational method to identify target nodes and reconstruct the corresponding error signal including detection of missing and wrong molecular interactions within the assumed model. The method works for ODE based systems even with uncertain knowledge and noisy data. In contrast to approaches based on point estimates the Bayesian framework incorporates the given uncertainty and circumvents numerical pitfalls which frequently arise from optimization methods (Engelhardt et al.Â 2017).</p>
<div id="bden" class="section level2">
<h2>BDEN</h2>
<p>The algorithm can be executed in a similar fashion as the DEN algorithm. However computational time is much higher. See demonstration on how to use the algorithm. For further information look into the documentation of the functions.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">library</span>(seeds)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>uvbParameter =<span class="st"> </span><span class="kw">c</span>(  <span class="dt">ks1=</span><span class="fl">0.23</span>,</span>
<span id="cb3-5"><a href="#cb3-5"></a>                   <span class="dt">ks2=</span><span class="fl">4.0526</span>,</span>
<span id="cb3-6"><a href="#cb3-6"></a>                   <span class="dt">kdr1=</span><span class="fl">0.1</span>,</span>
<span id="cb3-7"><a href="#cb3-7"></a>                   <span class="dt">kdr2=</span><span class="fl">0.2118</span>,</span>
<span id="cb3-8"><a href="#cb3-8"></a>                   <span class="dt">k1=</span><span class="fl">0.0043</span>,</span>
<span id="cb3-9"><a href="#cb3-9"></a>                   <span class="dt">k2=</span><span class="fl">161.62</span>,</span>
<span id="cb3-10"><a href="#cb3-10"></a>                   <span class="dt">ka1=</span><span class="fl">0.0372</span>,</span>
<span id="cb3-11"><a href="#cb3-11"></a>                   <span class="dt">ka2=</span><span class="fl">0.0611</span>,</span>
<span id="cb3-12"><a href="#cb3-12"></a>                   <span class="dt">ka3=</span><span class="fl">4.7207</span>,</span>
<span id="cb3-13"><a href="#cb3-13"></a>                   <span class="dt">kd1=</span><span class="fl">94.3524</span>,</span>
<span id="cb3-14"><a href="#cb3-14"></a>                   <span class="dt">kd2=</span><span class="fl">50.6973</span>,</span>
<span id="cb3-15"><a href="#cb3-15"></a>                   <span class="dt">kd3=</span><span class="fl">0.5508</span>,</span>
<span id="cb3-16"><a href="#cb3-16"></a>                   <span class="dt">ks3=</span><span class="fl">0.4397</span>,</span>
<span id="cb3-17"><a href="#cb3-17"></a>                   <span class="dt">kdr3=</span><span class="fl">1.246</span>,</span>
<span id="cb3-18"><a href="#cb3-18"></a>                   <span class="dt">uv=</span><span class="dv">1</span>,</span>
<span id="cb3-19"><a href="#cb3-19"></a>                   <span class="dt">ka4=</span><span class="fl">10.1285</span>,</span>
<span id="cb3-20"><a href="#cb3-20"></a>                   <span class="dt">kd4=</span><span class="fl">1.1999</span>,</span>
<span id="cb3-21"><a href="#cb3-21"></a>                   <span class="dt">n1=</span><span class="dv">3</span>,</span>
<span id="cb3-22"><a href="#cb3-22"></a>                   <span class="dt">n2=</span><span class="dv">2</span>,</span>
<span id="cb3-23"><a href="#cb3-23"></a>                   <span class="dt">n3=</span><span class="fl">3.5</span>,</span>
<span id="cb3-24"><a href="#cb3-24"></a>                   <span class="dt">kdr3a=</span><span class="fl">0.9735</span>,</span>
<span id="cb3-25"><a href="#cb3-25"></a>                   <span class="dt">kdr3b=</span><span class="fl">0.406</span>,</span>
<span id="cb3-26"><a href="#cb3-26"></a>                   <span class="dt">ksr=</span><span class="fl">0.7537</span>,</span>
<span id="cb3-27"><a href="#cb3-27"></a>                   <span class="dt">fhy3_s=</span><span class="dv">5</span>)</span>
<span id="cb3-28"><a href="#cb3-28"></a></span>
<span id="cb3-29"><a href="#cb3-29"></a>x0 =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">4.2</span>,<span class="fl">0.25</span>,<span class="dv">20</span>,<span class="dv">0</span>)<span class="op">+</span><span class="fl">0.00001</span></span>
<span id="cb3-30"><a href="#cb3-30"></a></span>
<span id="cb3-31"><a href="#cb3-31"></a>uvbModel &lt;-<span class="st"> </span><span class="cf">function</span>(t,x,parameters) {</span>
<span id="cb3-32"><a href="#cb3-32"></a>  <span class="kw">with</span> (<span class="kw">as.list</span>(parameters),{</span>
<span id="cb3-33"><a href="#cb3-33"></a>    </span>
<span id="cb3-34"><a href="#cb3-34"></a>    dx1 =<span class="st"> </span>((<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>((ka1 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(x[<span class="dv">4</span>]<span class="op">^</span><span class="dv">2</span>)) <span class="op">-</span><span class="st"> </span>(kd1 <span class="op">*</span><span class="st"> </span>x[<span class="dv">5</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-35"><a href="#cb3-35"></a><span class="st">             </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>((ka2 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>]) <span class="op">-</span><span class="st"> </span>(kd2 <span class="op">*</span><span class="st"> </span>x[<span class="dv">3</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-36"><a href="#cb3-36"></a><span class="st">             </span>((ks1 <span class="op">*</span>((<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(uv <span class="op">*</span><span class="st"> </span>n3 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">11</span>] <span class="op">+</span><span class="st"> </span>fhy3_s))))  <span class="op">-</span><span class="st"> </span></span>
<span id="cb3-37"><a href="#cb3-37"></a><span class="st">                </span>(kdr1 <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(n1 <span class="op">*</span><span class="st"> </span>uv)) <span class="op">*</span><span class="st"> </span>x[<span class="dv">1</span>])))</span>
<span id="cb3-38"><a href="#cb3-38"></a>    dx2 =<span class="st"> </span>((<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>((ka2<span class="op">*</span>(x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>]) <span class="op">-</span><span class="st"> </span>(kd2 <span class="op">*</span><span class="st"> </span>x[<span class="dv">3</span>])) <span class="op">+</span></span>
<span id="cb3-39"><a href="#cb3-39"></a><span class="st">             </span>(<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>((ka4 <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x[<span class="dv">12</span>]) <span class="op">-</span><span class="st"> </span>(kd4 <span class="op">*</span><span class="st"> </span>x[<span class="dv">13</span>])))</span>
<span id="cb3-40"><a href="#cb3-40"></a>    dx3 =<span class="st"> </span>(((ka2 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>]) <span class="op">-</span><span class="st"> </span>(kd2<span class="op">*</span><span class="st">  </span>x[<span class="dv">3</span>]))) </span>
<span id="cb3-41"><a href="#cb3-41"></a>    dx4 =<span class="st"> </span>((<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(k1<span class="op">*</span>(x[<span class="dv">4</span>]<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span>(<span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(k2 <span class="op">*</span><span class="st"> </span>x[<span class="dv">6</span>]) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-42"><a href="#cb3-42"></a><span class="st">             </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>((ka1 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="st"> </span>(x[<span class="dv">4</span>]<span class="op">^</span><span class="dv">2</span>)) <span class="op">-</span><span class="st"> </span>(kd1 <span class="op">*</span><span class="st"> </span>x[<span class="dv">5</span>])) <span class="op">+</span></span>
<span id="cb3-43"><a href="#cb3-43"></a><span class="st">             </span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="st"> </span>(ka3 <span class="op">*</span><span class="st"> </span>x[<span class="dv">4</span>] <span class="op">*</span>x[<span class="dv">7</span>]))</span>
<span id="cb3-44"><a href="#cb3-44"></a>    dx5 =<span class="st">  </span>(((ka1 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(x[<span class="dv">4</span>]<span class="op">^</span><span class="dv">2</span>)) <span class="op">-</span>(kd1 <span class="op">*</span><span class="st"> </span>x[<span class="dv">5</span>])))</span>
<span id="cb3-45"><a href="#cb3-45"></a>    dx6 =<span class="st"> </span>((<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(k2 <span class="op">*</span><span class="st"> </span>x[<span class="dv">6</span>]) <span class="op">+</span><span class="st">  </span>(k1 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">4</span>]<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span>(kd3 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">8</span>]<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb3-46"><a href="#cb3-46"></a>    dx7 =<span class="st"> </span>((<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(ka3 <span class="op">*</span><span class="st"> </span>x[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>x[<span class="dv">7</span>]) <span class="op">+</span><span class="st"> </span>((ks2 <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(uv <span class="op">*</span><span class="st"> </span>x[<span class="dv">5</span>]))) <span class="op">-</span><span class="st"> </span></span>
<span id="cb3-47"><a href="#cb3-47"></a><span class="st">                                           </span>(kdr2 <span class="op">*</span><span class="st"> </span>x[<span class="dv">7</span>])) <span class="op">+</span><span class="st"> </span>(<span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(kd3 <span class="op">*</span><span class="st"> </span>(x[<span class="dv">8</span>]<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb3-48"><a href="#cb3-48"></a>    dx8 =<span class="st"> </span>((<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(kd3 <span class="op">*</span><span class="st"> </span>x[<span class="dv">8</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(ka3 <span class="op">*</span><span class="st"> </span>x[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>x[<span class="dv">7</span>])) </span>
<span id="cb3-49"><a href="#cb3-49"></a>    dx9  =<span class="st"> </span><span class="dv">0</span> </span>
<span id="cb3-50"><a href="#cb3-50"></a>    dx10 =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb3-51"><a href="#cb3-51"></a>    dx11 =<span class="st">  </span>(((ks3 <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(n2 <span class="op">*</span><span class="st"> </span>uv))) <span class="op">-</span>(kdr3 <span class="op">*</span><span class="st"> </span>(((x[<span class="dv">3</span>] <span class="op">/</span><span class="st"> </span>(kdr3a <span class="op">+</span><span class="st"> </span>x[<span class="dv">3</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-52"><a href="#cb3-52"></a><span class="st">                                                     </span>(x[<span class="dv">13</span>] <span class="op">/</span><span class="st"> </span>(kdr3b <span class="op">+</span><span class="st"> </span>x[<span class="dv">13</span>]))) <span class="op">-</span>(x[<span class="dv">5</span>] <span class="op">/</span><span class="st"> </span>(ksr <span class="op">+</span><span class="st"> </span>x[<span class="dv">5</span>]))) <span class="op">*</span><span class="st">  </span>x[<span class="dv">11</span>])))</span>
<span id="cb3-53"><a href="#cb3-53"></a>    dx12 =<span class="st"> </span>((<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(ka4 <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x[<span class="dv">12</span>]) <span class="op">+</span><span class="st"> </span>(kd4 <span class="op">*</span><span class="st"> </span>x[<span class="dv">13</span>]))</span>
<span id="cb3-54"><a href="#cb3-54"></a>    dx13 =((ka4 <span class="op">*</span><span class="st"> </span>x[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x[<span class="dv">12</span>]) <span class="op">-</span><span class="st"> </span>(kd4 <span class="op">*</span><span class="st"> </span>x[<span class="dv">13</span>]))</span>
<span id="cb3-55"><a href="#cb3-55"></a>    </span>
<span id="cb3-56"><a href="#cb3-56"></a>    <span class="kw">list</span>(<span class="kw">c</span>(dx1,dx2,dx3,dx4,dx5,dx6,dx7,dx8,dx9,dx10,dx11,dx12,dx13))</span>
<span id="cb3-57"><a href="#cb3-57"></a>  })</span>
<span id="cb3-58"><a href="#cb3-58"></a>}</span>
<span id="cb3-59"><a href="#cb3-59"></a></span>
<span id="cb3-60"><a href="#cb3-60"></a></span>
<span id="cb3-61"><a href="#cb3-61"></a>uvbMeasure &lt;-<span class="st">   </span><span class="cf">function</span>(y,parameter){</span>
<span id="cb3-62"><a href="#cb3-62"></a>  </span>
<span id="cb3-63"><a href="#cb3-63"></a>  y1 =<span class="st"> </span><span class="dv">2</span><span class="op">*</span>y[,<span class="dv">5</span>] <span class="op">+</span><span class="st"> </span>y[,<span class="dv">4</span>] <span class="op">+</span><span class="st"> </span>y[,<span class="dv">8</span>]</span>
<span id="cb3-64"><a href="#cb3-64"></a>  y2 =<span class="st"> </span><span class="dv">2</span><span class="op">*</span>y[,<span class="dv">5</span>] <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="st"> </span>y[,<span class="dv">3</span>] <span class="op">+</span><span class="st"> </span>y[,<span class="dv">1</span>]</span>
<span id="cb3-65"><a href="#cb3-65"></a>  y3 =<span class="st"> </span>y[,<span class="dv">6</span>]</span>
<span id="cb3-66"><a href="#cb3-66"></a>  y4 =<span class="st"> </span>y[,<span class="dv">11</span>]</span>
<span id="cb3-67"><a href="#cb3-67"></a>  y5 =<span class="st"> </span>y[,<span class="dv">4</span>]</span>
<span id="cb3-68"><a href="#cb3-68"></a>  </span>
<span id="cb3-69"><a href="#cb3-69"></a>  <span class="kw">return</span>(<span class="kw">cbind</span>(y1,y2,y3,y4,y5))</span>
<span id="cb3-70"><a href="#cb3-70"></a>}</span>
<span id="cb3-71"><a href="#cb3-71"></a>  </span>
<span id="cb3-72"><a href="#cb3-72"></a></span>
<span id="cb3-73"><a href="#cb3-73"></a>testNN =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(x0))</span>
<span id="cb3-74"><a href="#cb3-74"></a>testNN[<span class="dv">1</span>] =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb3-75"><a href="#cb3-75"></a></span>
<span id="cb3-76"><a href="#cb3-76"></a></span>
<span id="cb3-77"><a href="#cb3-77"></a>y &lt;-<span class="st"> </span>uvbData[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]</span>
<span id="cb3-78"><a href="#cb3-78"></a>t &lt;-<span class="st"> </span>uvbData<span class="op">$</span>t</span>
<span id="cb3-79"><a href="#cb3-79"></a>sd &lt;-<span class="st"> </span>uvbData[,<span class="dv">7</span><span class="op">:</span><span class="dv">11</span>]</span>
<span id="cb3-80"><a href="#cb3-80"></a></span>
<span id="cb3-81"><a href="#cb3-81"></a></span>
<span id="cb3-82"><a href="#cb3-82"></a>Model &lt;-<span class="st"> </span><span class="kw">odeModel</span>(<span class="dt">func =</span> uvbModel, <span class="dt">parms =</span> uvbParameter,<span class="dt">times=</span><span class="kw">c</span>(<span class="fl">0.025</span>), </span>
<span id="cb3-83"><a href="#cb3-83"></a>                         <span class="dt">measFunc =</span> uvbMeasure, <span class="dt">y =</span> x0, <span class="dt">meas =</span> y, <span class="dt">sd =</span> sd,<span class="dt">custom=</span><span class="ot">TRUE</span>)</span>
<span id="cb3-84"><a href="#cb3-84"></a></span>
<span id="cb3-85"><a href="#cb3-85"></a></span>
<span id="cb3-86"><a href="#cb3-86"></a></span>
<span id="cb3-87"><a href="#cb3-87"></a>A &lt;-<span class="st"> </span><span class="kw">BDEN</span>(<span class="dt">odeModel          =</span> Model,</span>
<span id="cb3-88"><a href="#cb3-88"></a>          <span class="dt">lambda            =</span> <span class="fl">.001</span>,</span>
<span id="cb3-89"><a href="#cb3-89"></a>          <span class="dt">beta_init         =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb3-90"><a href="#cb3-90"></a>          <span class="dt">numbertrialsstep  =</span> <span class="dv">15</span>,</span>
<span id="cb3-91"><a href="#cb3-91"></a>          <span class="dt">numbertrialseps   =</span> <span class="dv">2000</span>,</span>
<span id="cb3-92"><a href="#cb3-92"></a>          <span class="dt">numbertrialinner  =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
